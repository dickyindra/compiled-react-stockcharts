{"version":3,"sources":["../../../src/lib/series/SARSeries.js"],"names":["SARSeries","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","mouseXY","currentItem","yScale","chartConfig","yAccessor","y","currentY","ctx","fill","opacity","xAccessor","plotData","xScale","hovering","width","d","length","radius","Math","min","max","forEach","centerX","each","centerY","color","close","falling","rising","fillStyle","strokeStyle","beginPath","ellipse","PI","closePath","stroke","className","filter","map","idx","highlightOnHover","hoverProps","drawOn","canvasToDraw","onClick","onDoubleClick","onContextMenu","propTypes","string","object","isRequired","func","number","bool","defaultProps","e","console","log"],"mappings":"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","file":"SARSeries.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\nimport { getAxisCanvas, getMouseCanvas } from \"../GenericComponent\";\r\n\r\nimport { isDefined, first, last, hexToRGBA } from \"../utils\";\r\n\r\nclass SARSeries extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t\tthis.isHover = this.isHover.bind(this);\r\n\t}\r\n\tisHover(moreProps) {\r\n\t\tconst { mouseXY, currentItem, chartConfig: { yScale } } = moreProps;\r\n\t\tconst { yAccessor } = this.props;\r\n\t\tconst y = mouseXY[1];\r\n\t\tconst currentY = yScale(yAccessor(currentItem));\r\n\t\treturn y <  currentY + 5 && y > currentY - 5;\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { yAccessor, fill, opacity } = this.props;\r\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale }, hovering } = moreProps;\r\n\r\n\t\tconst width = xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)));\r\n\r\n\t\tconst d = (width / plotData.length) * 0.5 / 2;\r\n\t\tconst radius = Math.min(2, Math.max(0.5,  d)) + (hovering ? 2 : 0);\r\n\r\n\t\tplotData.forEach(each => {\r\n\t\t\tconst centerX = xScale(xAccessor(each));\r\n\t\t\tconst centerY = yScale(yAccessor(each));\r\n\t\t\tconst color = yAccessor(each) > each.close\r\n\t\t\t\t? fill.falling\r\n\t\t\t\t: fill.rising;\r\n\r\n\t\t\tctx.fillStyle = hexToRGBA(color, opacity);\r\n\t\t\tctx.strokeStyle = color;\r\n\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.ellipse(centerX, centerY, radius, radius, 0, 0, 2 * Math.PI);\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fill();\r\n\t\t\tctx.stroke();\r\n\t\t});\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { className, yAccessor } = this.props;\r\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale } } = moreProps;\r\n\t\t// console.log(moreProps);\r\n\r\n\t\treturn <g className={className}>\r\n\t\t\t{plotData\r\n\t\t\t\t.filter(each => isDefined(yAccessor(each)))\r\n\t\t\t\t.map((each, idx) => {\r\n\t\t\t\t\treturn <circle key={idx} cx={xScale(xAccessor(each))}\r\n\t\t\t\t\t\tcy={yScale(yAccessor(each))} r={3} fill=\"green\" />;\r\n\t\t\t\t})}\r\n\t\t</g>;\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { highlightOnHover } = this.props;\r\n\t\tconst hoverProps = highlightOnHover\r\n\t\t\t? {\r\n\t\t\t\tisHover: this.isHover,\r\n\t\t\t\tdrawOn: [\"mousemove\", \"pan\"],\r\n\t\t\t\tcanvasToDraw: getMouseCanvas\r\n\t\t\t}\r\n\t\t\t: {\r\n\t\t\t\tdrawOn: [\"pan\"],\r\n\t\t\t\tcanvasToDraw: getAxisCanvas\r\n\t\t\t};\r\n\r\n\t\treturn <GenericChartComponent\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\r\n\t\t\tonClickWhenHover={this.props.onClick}\r\n\t\t\tonDoubleClickWhenHover={this.props.onDoubleClick}\r\n\t\t\tonContextMenuWhenHover={this.props.onContextMenu}\r\n\t\t\t{...hoverProps}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nSARSeries.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tfill: PropTypes.object.isRequired,\r\n\tyAccessor: PropTypes.func.isRequired,\r\n\topacity: PropTypes.number.isRequired,\r\n\tonClick: PropTypes.func,\r\n\tonDoubleClick: PropTypes.func,\r\n\tonContextMenu: PropTypes.func,\r\n\thighlightOnHover: PropTypes.bool,\r\n};\r\n\r\nSARSeries.defaultProps = {\r\n\tclassName: \"react-stockcharts-sar\",\r\n\tfill: {\r\n\t\tfalling: \"#4682B4\",\r\n\t\trising: \"#15EC2E\",\r\n\t},\r\n\thighlightOnHover: true,\r\n\topacity: 0.2,\r\n\tonClick: function(e) { console.log(\"Click\", e); },\r\n\tonDoubleClick: function(e) { console.log(\"Double Click\", e); },\r\n\tonContextMenu: function(e) { console.log(\"Right Click\", e); },\r\n};\r\n\r\nexport default SARSeries;\r\n"]}