{"version":3,"sources":["../../../../../src/lib/interactive/components/MouseLocationIndicator.js"],"names":["React","Component","PropTypes","GenericChartComponent","getMouseCanvas","isDefined","getClosestValue","noop","shallowEqual","functor","getXValue","MouseLocationIndicator","props","renderSVG","bind","drawOnCanvas","handleMousePosChange","handleMouseDown","handleClick","xy","mutableState","moreProps","e","pos","xValue","yValue","x","y","onMouseDown","onClick","xAccessor","plotData","mouseXY","currentItem","xScale","yScale","chartConfig","enabled","snap","shouldDisableSnap","snapTo","invert","mousXY","prevMouseXY","onMouseMove","ctx","r","stroke","strokeWidth","show","lineWidth","strokeStyle","moveTo","beginPath","arc","Math","PI","opacity","disablePan","handleContextMenu","propTypes","bool","isRequired","func","number","string","defaultProps"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;;AAEA,OAAOC,qBAAP,MAAkC,6BAAlC;AACA,SAASC,cAAT,QAA+B,wBAA/B;;AAEA,SAASC,SAAT,EAAoBC,eAApB,EAAqCC,IAArC,EAA2CC,YAA3C,EAAyDC,OAAzD,QAAwE,aAAxE;AACA,SAASC,SAAT,QAA0B,2BAA1B;;IAEMC,sB;;;AACL,iCAAYC,KAAZ,EAAmB;AAAA;;AAAA,8IACZA,KADY;;AAElB,QAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,OAAjB;AACA,QAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBD,IAAlB,OAApB;;AAEA,QAAKE,oBAAL,GAA4B,MAAKA,oBAAL,CAA0BF,IAA1B,OAA5B;AACA,QAAKG,eAAL,GAAuB,MAAKA,eAAL,CAAqBH,IAArB,OAAvB;AACA,QAAKI,WAAL,GAAmB,MAAKA,WAAL,CAAiBJ,IAAjB,OAAnB;AACA,QAAKK,EAAL,GAAU,MAAKA,EAAL,CAAQL,IAAR,OAAV;;AAEA,QAAKM,YAAL,GAAoB,EAApB;AAVkB;AAWlB;;;;kCACeC,S,EAAWC,C,EAAG;AAC7B,OAAMC,MAAM,KAAKJ,EAAL,CAAQE,SAAR,EAAmBC,CAAnB,CAAZ;AACA,OAAIjB,UAAUkB,GAAV,CAAJ,EAAoB;AAAA,QACXC,MADW,GACcD,GADd,CACXC,MADW;AAAA,QACHC,MADG,GACcF,GADd,CACHE,MADG;AAAA,QACKC,CADL,GACcH,GADd,CACKG,CADL;AAAA,QACQC,CADR,GACcJ,GADd,CACQI,CADR;;AAEnB,SAAKP,YAAL,GAAoB,EAAEM,IAAF,EAAKC,IAAL,EAApB;AACA,SAAKf,KAAL,CAAWgB,WAAX,CAAuB,CAACJ,MAAD,EAASC,MAAT,CAAvB,EAAyCJ,SAAzC,EAAoDC,CAApD;AACA;AACD;;;8BACWD,S,EAAWC,C,EAAG;AACzB,OAAMC,MAAM,KAAKJ,EAAL,CAAQE,SAAR,EAAmBC,CAAnB,CAAZ;AACA,OAAIjB,UAAUkB,GAAV,CAAJ,EAAoB;AAAA,QACXC,MADW,GACcD,GADd,CACXC,MADW;AAAA,QACHC,MADG,GACcF,GADd,CACHE,MADG;AAAA,QACKC,CADL,GACcH,GADd,CACKG,CADL;AAAA,QACQC,CADR,GACcJ,GADd,CACQI,CADR;;AAEnB,SAAKP,YAAL,GAAoB,EAAEM,IAAF,EAAKC,IAAL,EAApB;AACA,SAAKf,KAAL,CAAWiB,OAAX,CAAmB,CAACL,MAAD,EAASC,MAAT,CAAnB,EAAqCJ,SAArC,EAAgDC,CAAhD;AACA;AACD;;;qBACED,S,EAAWC,C,EAAG;AAAA,OACRQ,SADQ,GACgBT,SADhB,CACRS,SADQ;AAAA,OACGC,QADH,GACgBV,SADhB,CACGU,QADH;AAAA,OAERC,OAFQ,GAEkDX,SAFlD,CAERW,OAFQ;AAAA,OAECC,WAFD,GAEkDZ,SAFlD,CAECY,WAFD;AAAA,OAEcC,MAFd,GAEkDb,SAFlD,CAEca,MAFd;AAAA,OAEqCC,MAFrC,GAEkDd,SAFlD,CAEsBe,WAFtB,CAEqCD,MAFrC;AAAA,gBAGqC,KAAKvB,KAH1C;AAAA,OAGRyB,OAHQ,UAGRA,OAHQ;AAAA,OAGCC,IAHD,UAGCA,IAHD;AAAA,OAGOC,iBAHP,UAGOA,iBAHP;AAAA,OAG0BC,MAH1B,UAG0BA,MAH1B;;;AAKhB,OAAIH,WAAWhC,UAAU4B,WAAV,CAAX,IAAqC5B,UAAUiB,CAAV,CAAzC,EAAuD;AACtD,QAAME,SAAUc,QAAQ,CAACC,kBAAkBjB,CAAlB,CAAT,GACbQ,UAAUG,WAAV,CADa,GAEbvB,UAAUwB,MAAV,EAAkBJ,SAAlB,EAA6BE,OAA7B,EAAsCD,QAAtC,CAFH;AAGA,QAAMN,SAASa,QAAQ,CAACC,kBAAkBjB,CAAlB,CAAT,GACZhB,gBAAgBkC,OAAOP,WAAP,CAAhB,EAAqCE,OAAOM,MAAP,CAAcT,QAAQ,CAAR,CAAd,CAArC,CADY,GAEZG,OAAOM,MAAP,CAAcT,QAAQ,CAAR,CAAd,CAFH;;AAIA,QAAMN,IAAIQ,OAAOV,MAAP,CAAV;AACA,QAAMG,IAAIQ,OAAOV,MAAP,CAAV;;AAEA,WAAO,EAAED,cAAF,EAAUC,cAAV,EAAkBC,IAAlB,EAAqBC,IAArB,EAAP;AACA;AACD;;;uCACoBN,S,EAAWC,C,EAAG;AAClC,OAAI,CAACd,aAAaa,UAAUqB,MAAvB,EAA+BrB,UAAUsB,WAAzC,CAAL,EAA4D;AAC3D,QAAMpB,MAAM,KAAKJ,EAAL,CAAQE,SAAR,EAAmBC,CAAnB,CAAZ;AACA,QAAIjB,UAAUkB,GAAV,CAAJ,EAAoB;AAAA,SACXC,MADW,GACcD,GADd,CACXC,MADW;AAAA,SACHC,MADG,GACcF,GADd,CACHE,MADG;AAAA,SACKC,CADL,GACcH,GADd,CACKG,CADL;AAAA,SACQC,CADR,GACcJ,GADd,CACQI,CADR;;AAEnB,UAAKP,YAAL,GAAoB,EAAEM,IAAF,EAAKC,IAAL,EAApB;AACA,UAAKf,KAAL,CAAWgC,WAAX,CAAuB,CAACpB,MAAD,EAASC,MAAT,CAAvB,EAAyCH,CAAzC;AACA;AACD;AACD;;;+BACYuB,G,EAAKxB,S,EAAW;AAAA,iBACgB,KAAKT,KADrB;AAAA,OACpByB,OADoB,WACpBA,OADoB;AAAA,OACXS,CADW,WACXA,CADW;AAAA,OACRC,MADQ,WACRA,MADQ;AAAA,OACAC,WADA,WACAA,WADA;AAAA,uBAEX,KAAK5B,YAFM;AAAA,OAEpBM,CAFoB,iBAEpBA,CAFoB;AAAA,OAEjBC,CAFiB,iBAEjBA,CAFiB;AAAA,OAGpBsB,IAHoB,GAGX5B,SAHW,CAGpB4B,IAHoB;AAI5B;;AACA,OAAIZ,WAAWY,IAAX,IAAmB5C,UAAUqB,CAAV,CAAvB,EAAqC;AACpCmB,QAAIK,SAAJ,GAAgBF,WAAhB;AACAH,QAAIM,WAAJ,GAAkBJ,MAAlB;AACAF,QAAIO,MAAJ,CAAW1B,CAAX,EAAcC,CAAd;AACAkB,QAAIQ,SAAJ;AACAR,QAAIS,GAAJ,CAAQ5B,CAAR,EAAWC,CAAX,EAAcmB,CAAd,EAAiB,CAAjB,EAAoB,IAAIS,KAAKC,EAA7B,EAAiC,KAAjC;AACAX,QAAIE,MAAJ;AACA;AACA;AACD;;;4BACS1B,S,EAAW;AAAA,iBACiC,KAAKT,KADtC;AAAA,OACZyB,OADY,WACZA,OADY;AAAA,OACHS,CADG,WACHA,CADG;AAAA,OACAC,MADA,WACAA,MADA;AAAA,OACQC,WADR,WACQA,WADR;AAAA,OACqBS,OADrB,WACqBA,OADrB;AAAA,wBAEH,KAAKrC,YAFF;AAAA,OAEZM,CAFY,kBAEZA,CAFY;AAAA,OAETC,CAFS,kBAETA,CAFS;AAAA,OAGZsB,IAHY,GAGH5B,SAHG,CAGZ4B,IAHY;;AAKpB;AACA;;AAEA,UAAOZ,WAAWY,IAAX,IAAmB5C,UAAUqB,CAAV,CAAnB,GACJ;AACD,QAAIA,CADH;AAED,QAAIC,CAFH;AAGD,OAAGmB,CAHF;AAID,YAAQC,MAJP;AAKD,aAASU,OALR;AAMD,UAAK,MANJ;AAOD,iBAAaT,WAPZ,GADI,GASJ,IATH;AAWA;;;2BACQ;AAAA,iBACwB,KAAKpC,KAD7B;AAAA,OACAyB,OADA,WACAA,OADA;AAAA,OACSqB,UADT,WACSA,UADT;;AAER,UAAO,oBAAC,qBAAD;AACN,iBAAa,KAAKzC,eADZ;AAEN,aAAS,KAAKC,WAFR;AAGN,mBAAe,KAAKyC,iBAHd;AAIN,iBAAa,KAAK3C,oBAJZ;AAKN,WAAO,KAAKA,oBALN;;AAON,gBAAYqB,WAAWqB,UAPjB;;AASN,aAAS,KAAK7C,SATR;;AAWN,gBAAY,KAAKE,YAXX;AAYN,kBAAcX,cAZR;;AAcN,YAAQ,CAAC,WAAD,EAAc,KAAd;AAdF,KAAP;AAgBA;;;;EA/GmCH,S;;AAkHrCU,uBAAuBiD,SAAvB,GAAmC;AAClCvB,UAASnC,UAAU2D,IAAV,CAAeC,UADU;AAElCxB,OAAMpC,UAAU2D,IAAV,CAAeC,UAFa;AAGlCvB,oBAAmBrC,UAAU6D,IAAV,CAAeD,UAHA;AAIlCtB,SAAQtC,UAAU6D,IAJgB;;AAMlCnB,cAAa1C,UAAU6D,IAAV,CAAeD,UANM;AAOlClC,cAAa1B,UAAU6D,IAAV,CAAeD,UAPM;AAQlCjC,UAAS3B,UAAU6D,IAAV,CAAeD,UARU;AASlChB,IAAG5C,UAAU8D,MAAV,CAAiBF,UATc;AAUlCf,SAAQ7C,UAAU+D,MAAV,CAAiBH,UAVS;AAWlCd,cAAa9C,UAAU8D,MAAV,CAAiBF,UAXI;AAYlCL,UAASvD,UAAU8D,MAAV,CAAiBF,UAZQ;AAalCJ,aAAYxD,UAAU2D,IAAV,CAAeC;AAbO,CAAnC;;AAgBAnD,uBAAuBuD,YAAvB,GAAsC;AACrCtB,cAAarC,IADwB;AAErCqB,cAAarB,IAFwB;AAGrCsB,UAAStB,IAH4B;AAIrCgC,oBAAmB9B,QAAQ,KAAR,CAJkB;AAKrCsC,SAAQ,SAL6B;AAMrCC,cAAa,CANwB;AAOrCS,UAAS,CAP4B;AAQrCC,aAAY;AARyB,CAAtC;;AAWA,eAAe/C,sBAAf","file":"MouseLocationIndicator.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../../GenericComponent\";\r\n\r\nimport { isDefined, getClosestValue, noop, shallowEqual, functor } from \"../../utils\";\r\nimport { getXValue } from \"../../utils/ChartDataUtil\";\r\n\r\nclass MouseLocationIndicator extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\r\n\t\tthis.handleMousePosChange = this.handleMousePosChange.bind(this);\r\n\t\tthis.handleMouseDown = this.handleMouseDown.bind(this);\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t\tthis.xy = this.xy.bind(this);\r\n\r\n\t\tthis.mutableState = {};\r\n\t}\r\n\thandleMouseDown(moreProps, e) {\r\n\t\tconst pos = this.xy(moreProps, e);\r\n\t\tif (isDefined(pos)) {\r\n\t\t\tconst { xValue, yValue, x, y } = pos;\r\n\t\t\tthis.mutableState = { x, y };\r\n\t\t\tthis.props.onMouseDown([xValue, yValue], moreProps, e);\r\n\t\t}\r\n\t}\r\n\thandleClick(moreProps, e) {\r\n\t\tconst pos = this.xy(moreProps, e);\r\n\t\tif (isDefined(pos)) {\r\n\t\t\tconst { xValue, yValue, x, y } = pos;\r\n\t\t\tthis.mutableState = { x, y };\r\n\t\t\tthis.props.onClick([xValue, yValue], moreProps, e);\r\n\t\t}\r\n\t}\r\n\txy(moreProps, e) {\r\n\t\tconst { xAccessor, plotData } = moreProps;\r\n\t\tconst { mouseXY, currentItem, xScale, chartConfig: { yScale } } = moreProps;\r\n\t\tconst { enabled, snap, shouldDisableSnap, snapTo } = this.props;\r\n\r\n\t\tif (enabled && isDefined(currentItem) && isDefined(e)) {\r\n\t\t\tconst xValue =  snap && !shouldDisableSnap(e)\r\n\t\t\t\t? xAccessor(currentItem)\r\n\t\t\t\t: getXValue(xScale, xAccessor, mouseXY, plotData);\r\n\t\t\tconst yValue = snap && !shouldDisableSnap(e)\r\n\t\t\t\t? getClosestValue(snapTo(currentItem), yScale.invert(mouseXY[1]))\r\n\t\t\t\t: yScale.invert(mouseXY[1]);\r\n\r\n\t\t\tconst x = xScale(xValue);\r\n\t\t\tconst y = yScale(yValue);\r\n\r\n\t\t\treturn { xValue, yValue, x, y };\r\n\t\t}\r\n\t}\r\n\thandleMousePosChange(moreProps, e) {\r\n\t\tif (!shallowEqual(moreProps.mousXY, moreProps.prevMouseXY)) {\r\n\t\t\tconst pos = this.xy(moreProps, e);\r\n\t\t\tif (isDefined(pos)) {\r\n\t\t\t\tconst { xValue, yValue, x, y } = pos;\r\n\t\t\t\tthis.mutableState = { x, y };\r\n\t\t\t\tthis.props.onMouseMove([xValue, yValue], e);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { enabled, r, stroke, strokeWidth } = this.props;\r\n\t\tconst { x, y } = this.mutableState;\r\n\t\tconst { show } = moreProps;\r\n\t\t// console.log(show)\r\n\t\tif (enabled && show && isDefined(x)) {\r\n\t\t\tctx.lineWidth = strokeWidth;\r\n\t\t\tctx.strokeStyle = stroke;\r\n\t\t\tctx.moveTo(x, y);\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x, y, r, 0, 2 * Math.PI, false);\r\n\t\t\tctx.stroke();\r\n\t\t\t// ctx.fill();\r\n\t\t}\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { enabled, r, stroke, strokeWidth, opacity } = this.props;\r\n\t\tconst { x, y } = this.mutableState;\r\n\t\tconst { show } = moreProps;\r\n\r\n\t\t// console.log(\"HERE\")\r\n\t\t// console.log(stroke, strokeWidth, opacity)\r\n\r\n\t\treturn enabled && show && isDefined(x)\r\n\t\t\t? <circle\r\n\t\t\t\tcx={x}\r\n\t\t\t\tcy={y}\r\n\t\t\t\tr={r}\r\n\t\t\t\tstroke={stroke}\r\n\t\t\t\topacity={opacity}\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tstrokeWidth={strokeWidth} />\r\n\t\t\t: null;\r\n\r\n\t}\r\n\trender() {\r\n\t\tconst { enabled, disablePan } = this.props;\r\n\t\treturn <GenericChartComponent\r\n\t\t\tonMouseDown={this.handleMouseDown}\r\n\t\t\tonClick={this.handleClick}\r\n\t\t\tonContextMenu={this.handleContextMenu}\r\n\t\t\tonMouseMove={this.handleMousePosChange}\r\n\t\t\tonPan={this.handleMousePosChange}\r\n\r\n\t\t\tdisablePan={enabled && disablePan}\r\n\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tcanvasToDraw={getMouseCanvas}\r\n\r\n\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nMouseLocationIndicator.propTypes = {\r\n\tenabled: PropTypes.bool.isRequired,\r\n\tsnap: PropTypes.bool.isRequired,\r\n\tshouldDisableSnap: PropTypes.func.isRequired,\r\n\tsnapTo: PropTypes.func,\r\n\r\n\tonMouseMove: PropTypes.func.isRequired,\r\n\tonMouseDown: PropTypes.func.isRequired,\r\n\tonClick: PropTypes.func.isRequired,\r\n\tr: PropTypes.number.isRequired,\r\n\tstroke: PropTypes.string.isRequired,\r\n\tstrokeWidth: PropTypes.number.isRequired,\r\n\topacity: PropTypes.number.isRequired,\r\n\tdisablePan: PropTypes.bool.isRequired,\r\n};\r\n\r\nMouseLocationIndicator.defaultProps = {\r\n\tonMouseMove: noop,\r\n\tonMouseDown: noop,\r\n\tonClick: noop,\r\n\tshouldDisableSnap: functor(false),\r\n\tstroke: \"#000000\",\r\n\tstrokeWidth: 1,\r\n\topacity: 1,\r\n\tdisablePan: true,\r\n};\r\n\r\nexport default MouseLocationIndicator;"]}