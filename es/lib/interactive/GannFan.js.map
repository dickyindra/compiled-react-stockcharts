{"version":3,"sources":["../../../../src/lib/interactive/GannFan.js"],"names":["React","Component","PropTypes","isDefined","isNotDefined","noop","terminate","saveNodeType","isHoverForInteractiveType","EachGannFan","MouseLocationIndicator","HoverTextNearMouse","GannFan","props","handleStart","bind","handleEnd","handleDrawFan","handleDragFan","handleDragFanComplete","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","fans","rest","newfans","map","each","idx","selected","onComplete","xyValue","current","startXY","mouseMoved","endXY","onStart","xyValyue","e","appearance","d","enabled","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","overrideIndex","tempChannel","eachAppearance","propTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","fillOpacity","strokeWidth","edgeStroke","edgeFill","edgeStrokeWidth","r","fill","arrayOf","fontFamily","fontSize","fontFill","object","array","defaultProps","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"GannFan.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { isDefined, isNotDefined, noop } from \"../utils\";\r\nimport {\r\n\tterminate,\r\n\tsaveNodeType,\r\n\tisHoverForInteractiveType,\r\n} from \"./utils\";\r\nimport EachGannFan from \"./wrapper/EachGannFan\";\r\nimport MouseLocationIndicator from \"./components/MouseLocationIndicator\";\r\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\r\n\r\nclass GannFan extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleStart = this.handleStart.bind(this);\r\n\t\tthis.handleEnd = this.handleEnd.bind(this);\r\n\t\tthis.handleDrawFan = this.handleDrawFan.bind(this);\r\n\t\tthis.handleDragFan = this.handleDragFan.bind(this);\r\n\t\tthis.handleDragFanComplete = this.handleDragFanComplete.bind(this);\r\n\r\n\t\tthis.terminate = terminate.bind(this);\r\n\t\tthis.saveNodeType = saveNodeType.bind(this);\r\n\r\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"fans\")\r\n\t\t\t.bind(this);\r\n\r\n\t\tthis.nodes = [];\r\n\t\tthis.state = {};\r\n\t}\r\n\thandleDragFan(index, newXYValue) {\r\n\t\tthis.setState({\r\n\t\t\toverride: {\r\n\t\t\t\tindex,\r\n\t\t\t\t...newXYValue\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\thandleDragFanComplete(moreProps) {\r\n\t\tconst { override } = this.state;\r\n\t\tconst { fans } = this.props;\r\n\r\n\t\tif (isDefined(override)) {\r\n\t\t\tconst { index, ...rest } = override;\r\n\t\t\tconst newfans = fans\r\n\t\t\t\t.map((each, idx) => idx === index\r\n\t\t\t\t\t? { ...each, ...rest, selected: true }\r\n\t\t\t\t\t: each);\r\n\t\t\tthis.setState({\r\n\t\t\t\toverride: null,\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newfans, moreProps);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleDrawFan(xyValue) {\r\n\t\tconst { current } = this.state;\r\n\r\n\t\tif (isDefined(current) && isDefined(current.startXY)) {\r\n\t\t\tthis.mouseMoved = true;\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tstartXY: current.startXY,\r\n\t\t\t\t\tendXY: xyValue,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleStart(xyValue) {\r\n\t\tconst { current } = this.state;\r\n\r\n\t\tif (isNotDefined(current) || isNotDefined(current.startXY)) {\r\n\t\t\tthis.mouseMoved = false;\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tstartXY: xyValue,\r\n\t\t\t\t\tendXY: null,\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onStart();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleEnd(xyValyue, moreProps, e) {\r\n\t\tconst { current } = this.state;\r\n\t\tconst { fans, appearance } = this.props;\r\n\r\n\t\tif (this.mouseMoved\r\n\t\t\t&& isDefined(current)\r\n\t\t\t&& isDefined(current.startXY)\r\n\t\t) {\r\n\t\t\tconst newfans = [\r\n\t\t\t\t...fans.map(d => ({ ...d, selected: false })),\r\n\t\t\t\t{ ...current, selected: true, appearance }\r\n\t\t\t];\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: null,\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newfans, moreProps, e);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { enabled, appearance } = this.props;\r\n\t\tconst { currentPositionRadius, currentPositionStroke } = this.props;\r\n\t\tconst { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\r\n\t\tconst { hoverText, fans } = this.props;\r\n\t\tconst { current, override } = this.state;\r\n\t\tconst overrideIndex = isDefined(override) ? override.index : null;\r\n\r\n\t\tconst tempChannel = isDefined(current) && isDefined(current.endXY)\r\n\t\t\t? <EachGannFan\r\n\t\t\t\tinteractive={false}\r\n\t\t\t\t{...current}\r\n\t\t\t\tappearance={appearance}\r\n\t\t\t\thoverText={hoverText}\r\n\t\t\t/>\r\n\t\t\t: null;\r\n\r\n\t\treturn <g>\r\n\t\t\t{fans.map((each, idx) => {\r\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\r\n\t\t\t\t\t? { ...appearance, ...each.appearance }\r\n\t\t\t\t\t: appearance;\r\n\r\n\t\t\t\treturn <EachGannFan key={idx}\r\n\t\t\t\t\tref={this.saveNodeType(idx)}\r\n\t\t\t\t\tindex={idx}\r\n\t\t\t\t\tselected={each.selected}\r\n\t\t\t\t\t{...(idx === overrideIndex ? override : each)}\r\n\t\t\t\t\tappearance={eachAppearance}\r\n\t\t\t\t\thoverText={hoverText}\r\n\t\t\t\t\tonDrag={this.handleDragFan}\r\n\t\t\t\t\tonDragComplete={this.handleDragFanComplete}\r\n\t\t\t\t/>;\r\n\t\t\t})}\r\n\t\t\t{tempChannel}\r\n\t\t\t<MouseLocationIndicator\r\n\t\t\t\tenabled={enabled}\r\n\t\t\t\tsnap={false}\r\n\t\t\t\tr={currentPositionRadius}\r\n\t\t\t\tstroke={currentPositionStroke}\r\n\t\t\t\topacity={currentPositionOpacity}\r\n\t\t\t\tstrokeWidth={currentPositionStrokeWidth}\r\n\t\t\t\tonMouseDown={this.handleStart}\r\n\t\t\t\tonClick={this.handleEnd}\r\n\t\t\t\tonMouseMove={this.handleDrawFan}\r\n\t\t\t/>\r\n\t\t</g>;\r\n\t}\r\n}\r\n\r\n\r\nGannFan.propTypes = {\r\n\tenabled: PropTypes.bool.isRequired,\r\n\r\n\tonStart: PropTypes.func.isRequired,\r\n\tonComplete: PropTypes.func.isRequired,\r\n\tonSelect: PropTypes.func,\r\n\r\n\tcurrentPositionStroke: PropTypes.string,\r\n\tcurrentPositionStrokeWidth: PropTypes.number,\r\n\tcurrentPositionOpacity: PropTypes.number,\r\n\tcurrentPositionRadius: PropTypes.number,\r\n\r\n\tappearance: PropTypes.shape({\r\n\t\tstroke: PropTypes.string.isRequired,\r\n\t\tstrokeOpacity: PropTypes.number.isRequired,\r\n\t\tfillOpacity: PropTypes.number.isRequired,\r\n\t\tstrokeWidth: PropTypes.number.isRequired,\r\n\t\tedgeStroke: PropTypes.string.isRequired,\r\n\t\tedgeFill: PropTypes.string.isRequired,\r\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\r\n\t\tr: PropTypes.number.isRequired,\r\n\t\tfill: PropTypes.arrayOf(PropTypes.string).isRequired,\r\n\t\tfontFamily: PropTypes.string.isRequired,\r\n\t\tfontSize: PropTypes.number.isRequired,\r\n\t\tfontFill: PropTypes.string.isRequired,\r\n\t}).isRequired,\r\n\thoverText: PropTypes.object.isRequired,\r\n\r\n\tfans: PropTypes.array.isRequired,\r\n};\r\n\r\nGannFan.defaultProps = {\r\n\tappearance: {\r\n\t\tstroke: \"#000000\",\r\n\t\tfillOpacity: 0.2,\r\n\t\tstrokeOpacity: 1,\r\n\t\tstrokeWidth: 1,\r\n\t\tedgeStroke: \"#000000\",\r\n\t\tedgeFill: \"#FFFFFF\",\r\n\t\tedgeStrokeWidth: 1,\r\n\t\tr: 5,\r\n\t\tfill: [\r\n\t\t\t\"#e41a1c\",\r\n\t\t\t\"#377eb8\",\r\n\t\t\t\"#4daf4a\",\r\n\t\t\t\"#984ea3\",\r\n\t\t\t\"#ff7f00\",\r\n\t\t\t\"#ffff33\",\r\n\t\t\t\"#a65628\",\r\n\t\t\t\"#f781bf\",\r\n\t\t],\r\n\t\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\t\tfontSize: 12,\r\n\t\tfontFill: \"#000000\",\r\n\t},\r\n\r\n\tonStart: noop,\r\n\tonComplete: noop,\r\n\tonSelect: noop,\r\n\r\n\tcurrentPositionStroke: \"#000000\",\r\n\tcurrentPositionOpacity: 1,\r\n\tcurrentPositionStrokeWidth: 3,\r\n\tcurrentPositionRadius: 4,\r\n\r\n\thoverText: {\r\n\t\t...HoverTextNearMouse.defaultProps,\r\n\t\tenable: true,\r\n\t\tbgHeight: 18,\r\n\t\tbgWidth: 120,\r\n\t\ttext: \"Click to select object\",\r\n\t},\r\n\tfans: [],\r\n};\r\n\r\nexport default GannFan;\r\n"]}