{"version":3,"sources":["../../../../src/lib/interactive/DrawingObjectSelector.js"],"names":["React","Component","PropTypes","isDefined","noop","mapObject","head","getMorePropsForChart","getSelected","GenericComponent","getMouseCanvas","DrawingObjectSelector","props","handleClick","bind","handleDoubleClick","getInteraction","moreProps","e","preventDefault","onDoubleClick","enabled","interactives","allSelected","length","selected","item","type","chartId","object","objects","morePropsForChart","onSelect","getInteractiveNodes","drawingObjectMap","interactiveNodes","key","each","valueArray","node","undefined","valuePresent","Array","isArray","getSelectionState","propTypes","func","isRequired","bool","defaultProps"],"mappings":"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","file":"DrawingObjectSelector.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { isDefined, noop, mapObject, head } from \"../utils\";\r\nimport { getMorePropsForChart, getSelected } from \"./utils\";\r\n\r\nimport GenericComponent, { getMouseCanvas } from \"../GenericComponent\";\r\n\r\nclass DrawingObjectSelector extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t\tthis.handleDoubleClick = this.handleDoubleClick.bind(this);\r\n\t\tthis.getInteraction = this.getInteraction.bind(this);\r\n\t}\r\n\thandleDoubleClick(moreProps, e) {\r\n\t\te.preventDefault();\r\n\t\tconst { onDoubleClick } = this.props;\r\n\t\tconst { enabled } = this.props;\r\n\t\tif (!enabled) return;\r\n\r\n\t\tconst interactives = this.getInteraction(moreProps);\r\n\t\tconst allSelected = getSelected(interactives);\r\n\r\n\t\t// console.log(selected, interactives)\r\n\t\tif (allSelected.length > 0) {\r\n\t\t\tconst selected = head(allSelected);\r\n\t\t\tconst item = {\r\n\t\t\t\ttype: selected.type,\r\n\t\t\t\tchartId: selected.chartId,\r\n\t\t\t\tobject: head(selected.objects)\r\n\t\t\t};\r\n\t\t\tconst morePropsForChart = getMorePropsForChart(\r\n\t\t\t\tmoreProps, selected.chartId\r\n\t\t\t);\r\n\t\t\tonDoubleClick(item, morePropsForChart);\r\n\t\t}\r\n\t}\r\n\thandleClick(moreProps, e) {\r\n\t\te.preventDefault();\r\n\t\tconst { onSelect } = this.props;\r\n\t\tconst { enabled } = this.props;\r\n\t\tif (!enabled) return;\r\n\r\n\t\tconst interactives = this.getInteraction(moreProps);\r\n\r\n\t\tonSelect(interactives, moreProps);\r\n\t}\r\n\tgetInteraction(moreProps) {\r\n\t\tconst { getInteractiveNodes, drawingObjectMap } = this.props;\r\n\t\tconst interactiveNodes = getInteractiveNodes();\r\n\t\tconst interactives = mapObject(interactiveNodes, each => {\r\n\t\t\tconst key = drawingObjectMap[each.type];\r\n\r\n\t\t\tconst valueArray = isDefined(key)\r\n\t\t\t\t? each.node.props[key]\r\n\t\t\t\t: undefined;\r\n\r\n\t\t\tconst valuePresent = isDefined(valueArray)\r\n\t\t\t\t&& Array.isArray(valueArray)\r\n\t\t\t\t&& valueArray.length > 0;\r\n\t\t\tif (valuePresent) {\r\n\t\t\t\t// console.log(\"Value present for \", each.type, each.chartId);\r\n\t\t\t\tconst morePropsForChart = getMorePropsForChart(\r\n\t\t\t\t\tmoreProps, each.chartId\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconst objects = each.node.getSelectionState(morePropsForChart);\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype: each.type,\r\n\t\t\t\t\tchartId: each.chartId,\r\n\t\t\t\t\tobjects,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\ttype: each.type,\r\n\t\t\t\tchartId: each.chartId,\r\n\t\t\t\tobjects: [],\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\treturn interactives;\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<GenericComponent\r\n\t\t\t\tsvgDraw={noop}\r\n\t\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\t\tcanvasDraw={noop}\r\n\r\n\t\t\t\tonMouseDown={this.handleClick}\r\n\t\t\t\tonDoubleClick={this.handleDoubleClick}\r\n\r\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nDrawingObjectSelector.propTypes = {\r\n\tgetInteractiveNodes: PropTypes.func.isRequired,\r\n\tonSelect: PropTypes.func.isRequired,\r\n\tonDoubleClick: PropTypes.func.isRequired,\r\n\tdrawingObjectMap: PropTypes.object.isRequired,\r\n\tenabled: PropTypes.bool.isRequired,\r\n};\r\n\r\nDrawingObjectSelector.defaultProps = {\r\n\tenabled: true,\r\n\tonDoubleClick: noop,\r\n};\r\n\r\nexport default DrawingObjectSelector;\r\n"]}