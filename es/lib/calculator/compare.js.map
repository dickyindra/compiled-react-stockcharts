{"version":3,"sources":["../../../../src/lib/calculator/compare.js"],"names":["head","path","isDefined","isNotDefined","Change","defaultOptions","options","calculator","data","basePath","mainKeys","compareKeys","base","first","b","firsts","compareData","map","result","forEach","d","key","Object","keys","subkey","x","arguments","length"],"mappings":";;;;AAEA,SAASA,IAAT,EAAeC,IAAf,EAAqBC,SAArB,EAAgCC,YAAhC,QAAoD,UAApD;AACA,SAASC,UAAUC,cAAnB,QAAyC,gCAAzC;;AAEA,eAAe,YAAW;AACzB,KAAIC,UAAUD,cAAd;;AAEA,UAASE,UAAT,CAAoBC,IAApB,EAA0B;AAAA,iBACmBF,OADnB;AAAA,MACjBG,QADiB,YACjBA,QADiB;AAAA,MACPC,QADO,YACPA,QADO;AAAA,MACGC,WADH,YACGA,WADH;;AAEzB,MAAMC,OAAOX,KAAKQ,QAAL,CAAb;;AAEA,MAAMI,QAAQb,KAAKQ,IAAL,CAAd;AACA,MAAMM,IAAIF,KAAKC,KAAL,CAAV;;AAEA;AACA,MAAIE,SAAS,EAAb;;AAEA,MAAMC,cAAcR,KAAKS,GAAL,CAAS,aAAK;AACjC;AACA,OAAIC,SAAS,EAAb;;AAEAR,YAASS,OAAT,CAAiB,eAAO;AACvB,QAAI,QAAOC,EAAEC,GAAF,CAAP,MAAkB,QAAtB,EAAgC;AAC/BH,YAAOG,GAAP,IAAc,EAAd;AACAC,YAAOC,IAAP,CAAYH,EAAEC,GAAF,CAAZ,EAAoBF,OAApB,CAA4B,kBAAU;AACrCD,aAAOG,GAAP,EAAYG,MAAZ,IAAsB,CAACJ,EAAEC,GAAF,EAAOG,MAAP,IAAiBV,CAAlB,IAAuBA,CAA7C;AACA,MAFD;AAGA,KALD,MAKO;AACNI,YAAOG,GAAP,IAAc,CAACD,EAAEC,GAAF,IAASP,CAAV,IAAeA,CAA7B;AACA;AACD,IATD;;AAWAH,eAAYQ,OAAZ,CAAoB,eAAO;AAC1B,QAAIjB,UAAUkB,EAAEC,GAAF,CAAV,KAAqBlB,aAAaY,OAAOM,GAAP,CAAb,CAAzB,EAAoD;AACnDN,YAAOM,GAAP,IAAcD,EAAEC,GAAF,CAAd;AACA;AACD,QAAInB,UAAUkB,EAAEC,GAAF,CAAV,KAAqBnB,UAAUa,OAAOM,GAAP,CAAV,CAAzB,EAAiD;AAChDH,YAAOG,GAAP,IAAc,CAACD,EAAEC,GAAF,IAASN,OAAOM,GAAP,CAAV,IAAyBN,OAAOM,GAAP,CAAvC;AACA;AACD,IAPD;AAQA,UAAOH,MAAP;AACA,GAxBmB,CAApB;AAyBA;AACA,SAAOF,WAAP;AACA;AACDT,YAAWD,OAAX,GAAqB,UAASmB,CAAT,EAAY;AAChC,MAAI,CAACC,UAAUC,MAAf,EAAuB;AACtB,UAAOrB,OAAP;AACA;AACDA,yBAAeD,cAAf,EAAkCoB,CAAlC;AACA,SAAOlB,UAAP;AACA,EAND;AAOA,QAAOA,UAAP;AACA","file":"compare.js","sourcesContent":["\r\n\r\nimport { head, path, isDefined, isNotDefined } from \"../utils\";\r\nimport { Change as defaultOptions } from \"./defaultOptionsForComputation\";\r\n\r\nexport default function() {\r\n\tlet options = defaultOptions;\r\n\r\n\tfunction calculator(data) {\r\n\t\tconst { basePath, mainKeys, compareKeys } = options;\r\n\t\tconst base = path(basePath);\r\n\r\n\t\tconst first = head(data);\r\n\t\tconst b = base(first);\r\n\r\n\t\t// eslint-disable-next-line prefer-const\r\n\t\tlet firsts = {};\r\n\r\n\t\tconst compareData = data.map(d => {\r\n\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\tlet result = {};\r\n\r\n\t\t\tmainKeys.forEach(key => {\r\n\t\t\t\tif (typeof d[key] === \"object\") {\r\n\t\t\t\t\tresult[key] = {};\r\n\t\t\t\t\tObject.keys(d[key]).forEach(subkey => {\r\n\t\t\t\t\t\tresult[key][subkey] = (d[key][subkey] - b) / b;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult[key] = (d[key] - b) / b;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tcompareKeys.forEach(key => {\r\n\t\t\t\tif (isDefined(d[key]) && isNotDefined(firsts[key])) {\r\n\t\t\t\t\tfirsts[key] = d[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (isDefined(d[key]) && isDefined(firsts[key])) {\r\n\t\t\t\t\tresult[key] = (d[key] - firsts[key]) / firsts[key];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t});\r\n\t\t// console.log(compareData[20]);\r\n\t\treturn compareData;\r\n\t}\r\n\tcalculator.options = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn options;\r\n\t\t}\r\n\t\toptions = { ...defaultOptions, ...x };\r\n\t\treturn calculator;\r\n\t};\r\n\treturn calculator;\r\n}"]}