{"version":3,"sources":["../../../../src/lib/helper/SaveChartAsImage.js"],"names":["saveAsPng","isDefined","dx","dy","SaveChartAsImage","save","doc","container","background","cb","svgAsDataUri","getElementsByTagName","uri","image","Image","onload","canvas","createElement","width","height","context","getContext","fillStyle","fillRect","canvasList","i","length","each","parent","parentNode","getBoundingClientRect","rect","drawImage","left","top","toDataURL","src","saveWithWhiteBG","saveWithBG","saveWithDarkBG","saveChartAsImage","document","a","setAttribute","body","appendChild","addEventListener","removeChild","click"],"mappings":";;AAEA,OAAOA,SAAP,MAAsB,iBAAtB;AACA,SAASC,SAAT,QAA0B,UAA1B;;AAEA,IAAMC,KAAK,CAAX;AACA,IAAMC,KAAK,CAAX;;AAEA,IAAMC,mBAAmB;AACxBC,KADwB,gBACnBC,GADmB,EACdC,SADc,EACHC,UADG,EACSC,EADT,EACa;AACpCT,YAAUU,YAAV,CAAuBH,UAAUI,oBAAV,CAA+B,KAA/B,EAAsC,CAAtC,CAAvB,EAAiE,EAAjE,EAAqE,UAASC,GAAT,EAAc;AAClF;AACA,OAAIC,QAAQ,IAAIC,KAAJ,EAAZ;AACAD,SAAME,MAAN,GAAe,YAAW;;AAEzB;AACA,QAAIC,SAASV,IAAIW,aAAJ,CAAkB,QAAlB,CAAb;AACAD,WAAOE,KAAP,GAAeL,MAAMK,KAArB;AACAF,WAAOG,MAAP,GAAgBN,MAAMM,MAAtB;;AAEA;AACA,QAAIC,UAAUJ,OAAOK,UAAP,CAAkB,IAAlB,CAAd;;AAEA,QAAIpB,UAAUO,UAAV,CAAJ,EAA2B;AAC1BY,aAAQE,SAAR,GAAoBd,UAApB;AACAY,aAAQG,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuBP,OAAOE,KAA9B,EAAqCF,OAAOG,MAA5C;AACA;AACD,QAAMK,aAAajB,UAAUI,oBAAV,CAA+B,QAA/B,CAAnB;AACA,SAAK,IAAIc,IAAI,CAAb,EAAgBA,IAAID,WAAWE,MAA/B,EAAuCD,GAAvC,EAA4C;AAC3C,SAAME,OAAOH,WAAWC,CAAX,CAAb;AACA,SAAIxB,UAAU0B,IAAV,CAAJ,EAAqB;AACpB,UAAMC,SAASD,KAAKE,UAAL,CAAgBA,UAAhB,CAA2BC,qBAA3B,EAAf;AACA,UAAMC,OAAOJ,KAAKG,qBAAL,EAAb;AACAV,cAAQY,SAAR,CAAkBL,IAAlB,EAAwBI,KAAKE,IAAL,GAAYL,OAAOK,IAAnB,GAA0B/B,EAAlD,EAAsD6B,KAAKG,GAAL,GAAWN,OAAOM,GAAlB,GAAwB/B,EAA9E;AACA;AACD;;AAEDiB,YAAQY,SAAR,CAAkBnB,KAAlB,EAAyBX,EAAzB,EAA6BC,EAA7B;AACAM,OAAGO,OAAOmB,SAAP,CAAiB,WAAjB,CAAH;AACA,IA1BD;AA2BAtB,SAAMuB,GAAN,GAAYxB,GAAZ;AACA,GA/BD;AAgCA,EAlCuB;AAmCxByB,gBAnCwB,2BAmCR/B,GAnCQ,EAmCHC,SAnCG,EAmCQE,EAnCR,EAmCY;AACnC,SAAO,KAAK6B,UAAL,CAAgBhC,GAAhB,EAAqBC,SAArB,EAAgC,OAAhC,EAAyCE,EAAzC,CAAP;AACA,EArCuB;AAsCxB8B,eAtCwB,0BAsCTjC,GAtCS,EAsCJC,SAtCI,EAsCOE,EAtCP,EAsCW;AAClC,SAAO,KAAK6B,UAAL,CAAgBhC,GAAhB,EAAqBC,SAArB,EAAgC,SAAhC,EAA2CE,EAA3C,CAAP;AACA,EAxCuB;AAyCxB6B,WAzCwB,sBAyCbhC,GAzCa,EAyCRC,SAzCQ,EAyCGC,UAzCH,EAyCeC,EAzCf,EAyCmB;AAC1C,SAAO,KAAKJ,IAAL,CAAUC,GAAV,EAAeC,SAAf,EAA0BC,UAA1B,EAAsCC,EAAtC,CAAP;AACA,EA3CuB;AA4CxB+B,iBA5CwB,4BA4CPjC,SA5CO,EA4CI;AAC3B,OAAK8B,eAAL,CAAqBI,QAArB,EAA+BlC,SAA/B,EAA0C,UAAS6B,GAAT,EAAc;AACvD,OAAMM,IAAID,SAASxB,aAAT,CAAuB,GAAvB,CAAV;AACAyB,KAAEC,YAAF,CAAe,MAAf,EAAuBP,GAAvB;AACAM,KAAEC,YAAF,CAAe,UAAf,EAA2B,WAA3B;;AAEAF,YAASG,IAAT,CAAcC,WAAd,CAA0BH,CAA1B;AACAA,KAAEI,gBAAF,CAAmB,OAAnB,EAA4B,YAAS,OAAS;AAC7CJ,MAAEb,UAAF,CAAakB,WAAb,CAAyBL,CAAzB;AACA,IAFD;;AAIAA,KAAEM,KAAF;AACA,GAXD;AAYA;AAzDuB,CAAzB;;AA4DA,eAAe5C,gBAAf","file":"SaveChartAsImage.js","sourcesContent":["\r\n\r\nimport saveAsPng from \"save-svg-as-png\";\r\nimport { isDefined } from \"../utils\";\r\n\r\nconst dx = 0;\r\nconst dy = 0;\r\n\r\nconst SaveChartAsImage = {\r\n\tsave(doc, container, background, cb) {\r\n\t\tsaveAsPng.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function(uri) {\r\n\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\tlet image = new Image();\r\n\t\t\timage.onload = function() {\r\n\r\n\t\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\t\tlet canvas = doc.createElement(\"canvas\");\r\n\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\tcanvas.height = image.height;\r\n\r\n\t\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\t\tlet context = canvas.getContext(\"2d\");\r\n\r\n\t\t\t\tif (isDefined(background)) {\r\n\t\t\t\t\tcontext.fillStyle = background;\r\n\t\t\t\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t\t}\r\n\t\t\t\tconst canvasList = container.getElementsByTagName(\"canvas\");\r\n\t\t\t\tfor (let i = 0; i < canvasList.length; i++) {\r\n\t\t\t\t\tconst each = canvasList[i];\r\n\t\t\t\t\tif (isDefined(each)) {\r\n\t\t\t\t\t\tconst parent = each.parentNode.parentNode.getBoundingClientRect();\r\n\t\t\t\t\t\tconst rect = each.getBoundingClientRect();\r\n\t\t\t\t\t\tcontext.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontext.drawImage(image, dx, dy);\r\n\t\t\t\tcb(canvas.toDataURL(\"image/png\"));\r\n\t\t\t};\r\n\t\t\timage.src = uri;\r\n\t\t});\r\n\t},\r\n\tsaveWithWhiteBG(doc, container, cb) {\r\n\t\treturn this.saveWithBG(doc, container, \"white\", cb);\r\n\t},\r\n\tsaveWithDarkBG(doc, container, cb) {\r\n\t\treturn this.saveWithBG(doc, container, \"#303030\", cb);\r\n\t},\r\n\tsaveWithBG(doc, container, background, cb) {\r\n\t\treturn this.save(doc, container, background, cb);\r\n\t},\r\n\tsaveChartAsImage(container) {\r\n\t\tthis.saveWithWhiteBG(document, container, function(src) {\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.setAttribute(\"href\", src);\r\n\t\t\ta.setAttribute(\"download\", \"Chart.png\");\r\n\r\n\t\t\tdocument.body.appendChild(a);\r\n\t\t\ta.addEventListener(\"click\", function(/* e */) {\r\n\t\t\t\ta.parentNode.removeChild(a);\r\n\t\t\t});\r\n\r\n\t\t\ta.click();\r\n\t\t});\r\n\t}\r\n};\r\n\r\nexport default SaveChartAsImage;"]}